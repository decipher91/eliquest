function QuestController(e,t,n,r,o){"use strict";var c=o.localDB;o.remoteDB;e.changeLanguage=function(e){t.use(e)};var l="http://ipv4.myexternalip.com/json";n.get(l).success(function(t){e.ip=t.ip}).error(function(t){e.ip="ip not recognized"}),e.genders={male:{value:"Male",text:{ru:"Мужчина",en:"Male"}},female:{value:"Female",text:{ru:"Женщина",en:"Female"}}},e.lang="en",e.results=[],e.tasks=r,e.questInitialized=!1,e.initQuest=function(){e.questInitialized=!0,e.gender=e.genders.male},e.setValue=function(t){"Female"==t?e.gender=e.genders.female:e.gender=e.genders.male},e.submitQuest=function(){e.tasks?c.post({tasks:e.tasks,gender:e.gender,ip:e.ip}).then(function(t){console.log(t),e.$apply(function(){e.tasks=r,e.questInitialized=!1,e.gender=e.genders.male,e.userGender===e.genders.male})})["catch"](function(e){console.log(e)}):alert("no answers provided")}}function AdminController(e,t,n,r,o){"use strict";var c=o.localDB,l=o.remoteDB;e.lang="en",e.changeLanguage=function(e){t.use(e)},e.refresh=function(){c.allDocs({include_docs:!0,attachments:!0}).then(function(t){e.results=t.rows,e.$apply()})["catch"](function(e){console.log(e)})},e.refreshRemote=function(){l.allDocs({include_docs:!0,attachments:!0}).then(function(t){e.$apply(function(){e.results=t.rows})})["catch"](function(e){console.log(e)})},e.refreshRemote(),e.remove=function(t){c.get(t).then(function(e){return c.remove(e)}).then(function(t){e.refresh()})["catch"](function(e){console.log(e)})}}function Quest(e,t){"use strict";return{get:function(){var n=e.defer();return t({method:"GET",url:"tasks.json"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}}function Result(e,t){"use strict";var n=t.localDB,r=t.remoteDB;return{getLocal:function(){var t=e.defer();n.allDocs({include_docs:!0,attachments:!0}).then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})},getRemote:function(){var t=e.defer();r.allDocs({include_docs:!0,attachments:!0}).then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})}}}function pouchService(){"use strict";this.localDB=new PouchDB("quest"),this.remoteDB=new PouchDB("https://elinext:elinextquiz@elinext.cloudant.com/quiz")}function ipService(e,t){"use strict";return{get:function(){var n=e.defer(),r="http://ipv4.myexternalip.com/json";t.get(r).success(function(e){n.resolve(e)}).error(function(e){console.log(e),n.reject(e)})}}}angular.module("quest",["ionic","pouchdb","quest.controllers","quest.factories","quest.services","ngMaterial","pascalprecht.translate"]).run(["pouchService",function(e){var t=e.localDB,n=e.remoteDB;t.sync(n,{live:!0})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","$ionicConfigProvider","$mdThemingProvider","$translateProvider",function(e,t,n,r,o,c,l){e.state("home",{url:"/",templateUrl:"templates/home.html",controller:"QuestController",cache:!1,resolve:{tasks:["Quest",function(e){return e.get()}],ip:["ipService",function(e){return e.get()}]}}).state("admin",{url:"/admin",templateUrl:"templates/admin.html",controller:"AdminController",cache:!1,resolve:{local:["Result",function(e){return e.getLocal()}],remote:["Result",function(e){return e.getRemote()}]}}),t.otherwise("/"),r.useApplyAsync(!0),o.scrolling.jsScrolling(!1),o.backButton.text("").icon("ion ion-android-arrow-back"),c.theme("default").primaryPalette("amber").accentPalette("deep-purple",{"default":"900"}),l.translations("en",{QUIZ_TITLE:"New quiz",ADMIN_TITLE:"Results",GREETING:"Welcome",ADMIN_GREETING:"Current Results",INIT_BUTTON:"Start",SUBMIT_BUTTON:"Submit",GENDER:"Gender",LOCATION:"Location",REFRESH:"Refresh",REMOVE:"Remove"}).translations("ru",{QUIZ_TITLE:"Новая анкета",ADMIN_TITLE:"Результаты",GREETING:"Добро пожаловать",ADMIN_GREETING:"Текущие результаты",INIT_BUTTON:"Поехали!",SUBMIT_BUTTON:"Готово",GENDER:"Пол",LOCATION:"Местоположение",REFRESH:"Обновить",REMOVE:"Удалить"}),l.preferredLanguage("en")}]),angular.module("quest.controllers",[]).controller("QuestController",QuestController).controller("AdminController",AdminController),QuestController.$inject=["$scope","$translate","$http","tasks","pouchService"],AdminController.$inject=["$scope","$translate","local","remote","pouchService"],angular.module("quest.factories",[]).factory("Quest",Quest).factory("Result",Result),Quest.$inject=["$q","$http"],Result.$inject=["$q","pouchService"],angular.module("quest.services",[]).service("pouchService",pouchService).service("ipService",ipService),pouchService.$inject=[],ipService.$inject=["$q","$http"];